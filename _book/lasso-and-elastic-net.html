<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Lasso and Elastic Net | Disciplined Convex Optimization in R</title>
  <meta name="description" content="Chapter 10 Lasso and Elastic Net | Disciplined Convex Optimization in R" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Lasso and Elastic Net | Disciplined Convex Optimization in R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Lasso and Elastic Net | Disciplined Convex Optimization in R" />
  
  
  

<meta name="author" content="Anqi Fu, Balasubramanian Narasimhan, Stephen Boyd" />


<meta name="date" content="2021-07-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="isotonic-regression.html"/>
<link rel="next" href="nearly-isotonic-fits.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script>
  // Added visibility option for solution (naras@stat)
  $(document).ready(function () {
      process_solutions();
  });
  function process_solutions() {
      $("div.section[id^='solution']").each(function(i) {
	  var soln_wrapper_id = "cvxr_ex_" + i;
	  var solution_id = $(this).attr('id');
	  var button = $("<button onclick=\"toggle_solution('" + soln_wrapper_id + "')\">Show/Hide</button>");
	  var new_div = $("<div id='" + soln_wrapper_id + "' class='solution' style='display: none;'></div>");
	  var h = $(this).first();
	  var others = $(this).children().slice(1);
	  $(others).each(function() {
	      $(this).appendTo($(new_div));
	  });
	  $(button).insertAfter($(h));
	  $(new_div).insertAfter($(button));
      })
  }
  function toggle_solution(el_id) {
      $("#" + el_id).toggle();
  } 
</script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Disciplined Convex Optimization in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#convex-problems-in-statistics-machine-learning"><i class="fa fa-check"></i><b>1.1</b> Convex Problems in Statistics, Machine Learning</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#non-convex-problems"><i class="fa fa-check"></i><b>1.2</b> Non-convex Problems</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>2</b> Getting Started</a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started.html"><a href="getting-started.html#solver-prerequisites"><i class="fa fa-check"></i><b>2.1</b> Solver Prerequisites</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="getting-started.html"><a href="getting-started.html#mosek"><i class="fa fa-check"></i><b>2.1.1</b> MOSEK</a></li>
<li class="chapter" data-level="2.1.2" data-path="getting-started.html"><a href="getting-started.html#gurobi"><i class="fa fa-check"></i><b>2.1.2</b> GUROBI</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="types-of-convex-optimization-problems.html"><a href="types-of-convex-optimization-problems.html"><i class="fa fa-check"></i><b>3</b> Types of Convex Optimization Problems</a>
<ul>
<li class="chapter" data-level="3.1" data-path="types-of-convex-optimization-problems.html"><a href="types-of-convex-optimization-problems.html#linear-programs"><i class="fa fa-check"></i><b>3.1</b> Linear Programs</a></li>
<li class="chapter" data-level="3.2" data-path="types-of-convex-optimization-problems.html"><a href="types-of-convex-optimization-problems.html#quadratic-programs"><i class="fa fa-check"></i><b>3.2</b> Quadratic Programs</a></li>
<li class="chapter" data-level="3.3" data-path="types-of-convex-optimization-problems.html"><a href="types-of-convex-optimization-problems.html#cone-programs"><i class="fa fa-check"></i><b>3.3</b> Cone Programs</a></li>
<li class="chapter" data-level="3.4" data-path="types-of-convex-optimization-problems.html"><a href="types-of-convex-optimization-problems.html#integer-and-mixed-integer-programs"><i class="fa fa-check"></i><b>3.4</b> Integer and Mixed Integer Programs</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="solving-convex-problems.html"><a href="solving-convex-problems.html"><i class="fa fa-check"></i><b>4</b> Solving Convex Problems</a>
<ul>
<li class="chapter" data-level="4.1" data-path="solving-convex-problems.html"><a href="solving-convex-problems.html#verifying-convexity"><i class="fa fa-check"></i><b>4.1</b> Verifying Convexity</a></li>
<li class="chapter" data-level="4.2" data-path="solving-convex-problems.html"><a href="solving-convex-problems.html#domain-specific-languages-for-convex-optimization"><i class="fa fa-check"></i><b>4.2</b> Domain Specific Languages for Convex Optimization</a></li>
<li class="chapter" data-level="4.3" data-path="solving-convex-problems.html"><a href="solving-convex-problems.html#references"><i class="fa fa-check"></i><b>4.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="disciplined-convex-programming.html"><a href="disciplined-convex-programming.html"><i class="fa fa-check"></i><b>5</b> Disciplined Convex Programming</a>
<ul>
<li class="chapter" data-level="5.1" data-path="disciplined-convex-programming.html"><a href="disciplined-convex-programming.html#basic-convex-functions"><i class="fa fa-check"></i><b>5.1</b> Basic Convex Functions</a></li>
<li class="chapter" data-level="5.2" data-path="disciplined-convex-programming.html"><a href="disciplined-convex-programming.html#calculus-rules"><i class="fa fa-check"></i><b>5.2</b> Calculus Rules</a></li>
<li class="chapter" data-level="5.3" data-path="disciplined-convex-programming.html"><a href="disciplined-convex-programming.html#examples"><i class="fa fa-check"></i><b>5.3</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="a-simple-regression-example.html"><a href="a-simple-regression-example.html"><i class="fa fa-check"></i><b>6</b> A Simple Regression Example</a>
<ul>
<li class="chapter" data-level="6.1" data-path="a-simple-regression-example.html"><a href="a-simple-regression-example.html#goals"><i class="fa fa-check"></i><b>6.1</b> Goals</a></li>
<li class="chapter" data-level="6.2" data-path="a-simple-regression-example.html"><a href="a-simple-regression-example.html#ordinary-least-squares-regression"><i class="fa fa-check"></i><b>6.2</b> Ordinary Least-Squares Regression</a></li>
<li class="chapter" data-level="6.3" data-path="a-simple-regression-example.html"><a href="a-simple-regression-example.html#the-cvxr-formulation"><i class="fa fa-check"></i><b>6.3</b> The <code>CVXR</code> Formulation</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="a-simple-regression-example.html"><a href="a-simple-regression-example.html#exercise"><i class="fa fa-check"></i><b>6.3.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="a-simple-regression-example.html"><a href="a-simple-regression-example.html#adding-constraints"><i class="fa fa-check"></i><b>6.4</b> Adding Constraints</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="a-simple-regression-example.html"><a href="a-simple-regression-example.html#exercise-1"><i class="fa fa-check"></i><b>6.4.1</b> Exercise</a></li>
<li class="chapter" data-level="6.4.2" data-path="a-simple-regression-example.html"><a href="a-simple-regression-example.html#exercise-2"><i class="fa fa-check"></i><b>6.4.2</b> Exercise</a></li>
<li class="chapter" data-level="6.4.3" data-path="a-simple-regression-example.html"><a href="a-simple-regression-example.html#exercise-3"><i class="fa fa-check"></i><b>6.4.3</b> Exercise</a></li>
<li class="chapter" data-level="6.4.4" data-path="a-simple-regression-example.html"><a href="a-simple-regression-example.html#exercise-4"><i class="fa fa-check"></i><b>6.4.4</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="a-simple-regression-example.html"><a href="a-simple-regression-example.html#summary"><i class="fa fa-check"></i><b>6.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="how-cvxr-works.html"><a href="how-cvxr-works.html"><i class="fa fa-check"></i><b>7</b> How <code>CVXR</code> Works</a>
<ul>
<li class="chapter" data-level="7.1" data-path="how-cvxr-works.html"><a href="how-cvxr-works.html#variables"><i class="fa fa-check"></i><b>7.1</b> Variables</a></li>
<li class="chapter" data-level="7.2" data-path="how-cvxr-works.html"><a href="how-cvxr-works.html#objectives-constraints-and-problems"><i class="fa fa-check"></i><b>7.2</b> Objectives, Constraints, and Problems</a></li>
<li class="chapter" data-level="7.3" data-path="how-cvxr-works.html"><a href="how-cvxr-works.html#solving-the-problem"><i class="fa fa-check"></i><b>7.3</b> Solving the Problem</a></li>
<li class="chapter" data-level="7.4" data-path="how-cvxr-works.html"><a href="how-cvxr-works.html#solver-options"><i class="fa fa-check"></i><b>7.4</b> Solver Options</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>8</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="8.1" data-path="logistic-regression.html"><a href="logistic-regression.html#goals-1"><i class="fa fa-check"></i><b>8.1</b> Goals</a></li>
<li class="chapter" data-level="8.2" data-path="logistic-regression.html"><a href="logistic-regression.html#logistic-regression-problem"><i class="fa fa-check"></i><b>8.2</b> Logistic Regression Problem</a></li>
<li class="chapter" data-level="8.3" data-path="logistic-regression.html"><a href="logistic-regression.html#example"><i class="fa fa-check"></i><b>8.3</b> Example</a></li>
<li class="chapter" data-level="8.4" data-path="logistic-regression.html"><a href="logistic-regression.html#exercise-5"><i class="fa fa-check"></i><b>8.4</b> Exercise</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="logistic-regression.html"><a href="logistic-regression.html#solution-5"><i class="fa fa-check"></i><b>8.4.1</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="logistic-regression.html"><a href="logistic-regression.html#references-1"><i class="fa fa-check"></i><b>8.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="isotonic-regression.html"><a href="isotonic-regression.html"><i class="fa fa-check"></i><b>9</b> Isotonic Regression</a>
<ul>
<li class="chapter" data-level="9.1" data-path="isotonic-regression.html"><a href="isotonic-regression.html#goals-2"><i class="fa fa-check"></i><b>9.1</b> Goals</a></li>
<li class="chapter" data-level="9.2" data-path="isotonic-regression.html"><a href="isotonic-regression.html#pituitary-data-example"><i class="fa fa-check"></i><b>9.2</b> Pituitary Data Example</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="isotonic-regression.html"><a href="isotonic-regression.html#exercise-6"><i class="fa fa-check"></i><b>9.2.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="isotonic-regression.html"><a href="isotonic-regression.html#handling-ties"><i class="fa fa-check"></i><b>9.3</b> Handling Ties</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="isotonic-regression.html"><a href="isotonic-regression.html#exercise-7"><i class="fa fa-check"></i><b>9.3.1</b> Exercise</a></li>
<li class="chapter" data-level="9.3.2" data-path="isotonic-regression.html"><a href="isotonic-regression.html#exercise-8"><i class="fa fa-check"></i><b>9.3.2</b> Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="lasso-and-elastic-net.html"><a href="lasso-and-elastic-net.html"><i class="fa fa-check"></i><b>10</b> Lasso and Elastic Net</a>
<ul>
<li class="chapter" data-level="10.1" data-path="lasso-and-elastic-net.html"><a href="lasso-and-elastic-net.html#goals-3"><i class="fa fa-check"></i><b>10.1</b> Goals</a></li>
<li class="chapter" data-level="10.2" data-path="lasso-and-elastic-net.html"><a href="lasso-and-elastic-net.html#regularized-regression"><i class="fa fa-check"></i><b>10.2</b> Regularized Regression</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="lasso-and-elastic-net.html"><a href="lasso-and-elastic-net.html#exercise-9"><i class="fa fa-check"></i><b>10.2.1</b> Exercise</a></li>
<li class="chapter" data-level="10.2.2" data-path="lasso-and-elastic-net.html"><a href="lasso-and-elastic-net.html#exercise-10"><i class="fa fa-check"></i><b>10.2.2</b> Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="nearly-isotonic-fits.html"><a href="nearly-isotonic-fits.html"><i class="fa fa-check"></i><b>11</b> Nearly Isotonic Fits</a>
<ul>
<li class="chapter" data-level="11.1" data-path="nearly-isotonic-fits.html"><a href="nearly-isotonic-fits.html#goals-4"><i class="fa fa-check"></i><b>11.1</b> Goals</a></li>
<li class="chapter" data-level="11.2" data-path="nearly-isotonic-fits.html"><a href="nearly-isotonic-fits.html#global-warming-example"><i class="fa fa-check"></i><b>11.2</b> Global Warming Example</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="nearly-isotonic-fits.html"><a href="nearly-isotonic-fits.html#exercise-11"><i class="fa fa-check"></i><b>11.2.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="nearly-isotonic-fits.html"><a href="nearly-isotonic-fits.html#references-2"><i class="fa fa-check"></i><b>11.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="speed-considerations.html"><a href="speed-considerations.html"><i class="fa fa-check"></i><b>12</b> Speed Considerations</a></li>
<li class="chapter" data-level="13" data-path="pliable-lasso.html"><a href="pliable-lasso.html"><i class="fa fa-check"></i><b>13</b> Pliable Lasso</a>
<ul>
<li class="chapter" data-level="13.1" data-path="pliable-lasso.html"><a href="pliable-lasso.html#goals-5"><i class="fa fa-check"></i><b>13.1</b> Goals</a></li>
<li class="chapter" data-level="13.2" data-path="pliable-lasso.html"><a href="pliable-lasso.html#pliable-lasso-problem"><i class="fa fa-check"></i><b>13.2</b> Pliable Lasso Problem</a></li>
<li class="chapter" data-level="13.3" data-path="pliable-lasso.html"><a href="pliable-lasso.html#example-1"><i class="fa fa-check"></i><b>13.3</b> Example</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="pliable-lasso.html"><a href="pliable-lasso.html#parameters"><i class="fa fa-check"></i><b>13.3.1</b> Parameters</a></li>
<li class="chapter" data-level="13.3.2" data-path="pliable-lasso.html"><a href="pliable-lasso.html#penalty-terms"><i class="fa fa-check"></i><b>13.3.2</b> Penalty Terms</a></li>
<li class="chapter" data-level="13.3.3" data-path="pliable-lasso.html"><a href="pliable-lasso.html#fitted-value"><i class="fa fa-check"></i><b>13.3.3</b> Fitted Value</a></li>
<li class="chapter" data-level="13.3.4" data-path="pliable-lasso.html"><a href="pliable-lasso.html#objective-function"><i class="fa fa-check"></i><b>13.3.4</b> Objective Function</a></li>
<li class="chapter" data-level="13.3.5" data-path="pliable-lasso.html"><a href="pliable-lasso.html#solving-the-problem-1"><i class="fa fa-check"></i><b>13.3.5</b> Solving the Problem</a></li>
<li class="chapter" data-level="13.3.6" data-path="pliable-lasso.html"><a href="pliable-lasso.html#return-values"><i class="fa fa-check"></i><b>13.3.6</b> Return Values</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="pliable-lasso.html"><a href="pliable-lasso.html#full-function"><i class="fa fa-check"></i><b>13.4</b> Full Function</a></li>
<li class="chapter" data-level="13.5" data-path="pliable-lasso.html"><a href="pliable-lasso.html#results"><i class="fa fa-check"></i><b>13.5</b> Results</a></li>
<li class="chapter" data-level="13.6" data-path="pliable-lasso.html"><a href="pliable-lasso.html#final-comments"><i class="fa fa-check"></i><b>13.6</b> Final Comments</a></li>
<li class="chapter" data-level="13.7" data-path="pliable-lasso.html"><a href="pliable-lasso.html#references-3"><i class="fa fa-check"></i><b>13.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="survey-calibration.html"><a href="survey-calibration.html"><i class="fa fa-check"></i><b>14</b> Survey Calibration</a>
<ul>
<li class="chapter" data-level="14.1" data-path="survey-calibration.html"><a href="survey-calibration.html#goals-6"><i class="fa fa-check"></i><b>14.1</b> Goals</a></li>
<li class="chapter" data-level="14.2" data-path="survey-calibration.html"><a href="survey-calibration.html#survey-calibration-problem"><i class="fa fa-check"></i><b>14.2</b> Survey Calibration Problem</a></li>
<li class="chapter" data-level="14.3" data-path="survey-calibration.html"><a href="survey-calibration.html#raking"><i class="fa fa-check"></i><b>14.3</b> Raking</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="survey-calibration.html"><a href="survey-calibration.html#exercise-12"><i class="fa fa-check"></i><b>14.3.1</b> Exercise</a></li>
<li class="chapter" data-level="14.3.2" data-path="survey-calibration.html"><a href="survey-calibration.html#exercise-13"><i class="fa fa-check"></i><b>14.3.2</b> Exercise</a></li>
<li class="chapter" data-level="14.3.3" data-path="survey-calibration.html"><a href="survey-calibration.html#solution-13"><i class="fa fa-check"></i><b>14.3.3</b> Solution</a></li>
<li class="chapter" data-level="14.3.4" data-path="survey-calibration.html"><a href="survey-calibration.html#exercise-14"><i class="fa fa-check"></i><b>14.3.4</b> Exercise</a></li>
<li class="chapter" data-level="14.3.5" data-path="survey-calibration.html"><a href="survey-calibration.html#exercise-15"><i class="fa fa-check"></i><b>14.3.5</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="survey-calibration.html"><a href="survey-calibration.html#references-4"><i class="fa fa-check"></i><b>14.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="sparse-inverse-covariance-estimation.html"><a href="sparse-inverse-covariance-estimation.html"><i class="fa fa-check"></i><b>15</b> Sparse Inverse Covariance Estimation</a>
<ul>
<li class="chapter" data-level="15.1" data-path="sparse-inverse-covariance-estimation.html"><a href="sparse-inverse-covariance-estimation.html#goals-7"><i class="fa fa-check"></i><b>15.1</b> Goals</a></li>
<li class="chapter" data-level="15.2" data-path="sparse-inverse-covariance-estimation.html"><a href="sparse-inverse-covariance-estimation.html#sparse-inverse-covariance-problem"><i class="fa fa-check"></i><b>15.2</b> Sparse Inverse Covariance Problem</a></li>
<li class="chapter" data-level="15.3" data-path="sparse-inverse-covariance-estimation.html"><a href="sparse-inverse-covariance-estimation.html#example-2"><i class="fa fa-check"></i><b>15.3</b> Example</a></li>
<li class="chapter" data-level="15.4" data-path="sparse-inverse-covariance-estimation.html"><a href="sparse-inverse-covariance-estimation.html#results-1"><i class="fa fa-check"></i><b>15.4</b> Results</a></li>
<li class="chapter" data-level="15.5" data-path="sparse-inverse-covariance-estimation.html"><a href="sparse-inverse-covariance-estimation.html#references-5"><i class="fa fa-check"></i><b>15.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="portfolio-estimation.html"><a href="portfolio-estimation.html"><i class="fa fa-check"></i><b>16</b> Portfolio Estimation</a>
<ul>
<li class="chapter" data-level="16.1" data-path="portfolio-estimation.html"><a href="portfolio-estimation.html#goals-8"><i class="fa fa-check"></i><b>16.1</b> Goals</a></li>
<li class="chapter" data-level="16.2" data-path="portfolio-estimation.html"><a href="portfolio-estimation.html#markowitz-portfolio-problem"><i class="fa fa-check"></i><b>16.2</b> Markowitz Portfolio Problem</a></li>
<li class="chapter" data-level="16.3" data-path="portfolio-estimation.html"><a href="portfolio-estimation.html#example-3"><i class="fa fa-check"></i><b>16.3</b> Example</a></li>
<li class="chapter" data-level="16.4" data-path="portfolio-estimation.html"><a href="portfolio-estimation.html#discussion"><i class="fa fa-check"></i><b>16.4</b> Discussion</a></li>
<li class="chapter" data-level="16.5" data-path="portfolio-estimation.html"><a href="portfolio-estimation.html#references-6"><i class="fa fa-check"></i><b>16.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="using-other-solvers.html"><a href="using-other-solvers.html"><i class="fa fa-check"></i><b>17</b> Using Other Solvers</a>
<ul>
<li class="chapter" data-level="17.1" data-path="using-other-solvers.html"><a href="using-other-solvers.html#goals-9"><i class="fa fa-check"></i><b>17.1</b> Goals</a></li>
<li class="chapter" data-level="17.2" data-path="using-other-solvers.html"><a href="using-other-solvers.html#default-solvers"><i class="fa fa-check"></i><b>17.2</b> Default Solvers</a></li>
<li class="chapter" data-level="17.3" data-path="using-other-solvers.html"><a href="using-other-solvers.html#commercial-solvers"><i class="fa fa-check"></i><b>17.3</b> Commercial Solvers</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="using-other-solvers.html"><a href="using-other-solvers.html#installing-mosek"><i class="fa fa-check"></i><b>17.3.1</b> Installing <code>MOSEK</code></a></li>
<li class="chapter" data-level="17.3.2" data-path="using-other-solvers.html"><a href="using-other-solvers.html#installing-gurobi"><i class="fa fa-check"></i><b>17.3.2</b> Installing <code>GUROBI</code></a></li>
<li class="chapter" data-level="17.3.3" data-path="using-other-solvers.html"><a href="using-other-solvers.html#gotchas"><i class="fa fa-check"></i><b>17.3.3</b> Gotchas</a></li>
<li class="chapter" data-level="17.3.4" data-path="using-other-solvers.html"><a href="using-other-solvers.html#example-session"><i class="fa fa-check"></i><b>17.3.4</b> Example Session</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="using-other-solvers.html"><a href="using-other-solvers.html#solver-peculiarities"><i class="fa fa-check"></i><b>17.4</b> Solver Peculiarities</a></li>
<li class="chapter" data-level="17.5" data-path="using-other-solvers.html"><a href="using-other-solvers.html#references-7"><i class="fa fa-check"></i><b>17.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="the-structure-of-atoms.html"><a href="the-structure-of-atoms.html"><i class="fa fa-check"></i><b>18</b> The Structure of Atoms</a>
<ul>
<li class="chapter" data-level="18.1" data-path="the-structure-of-atoms.html"><a href="the-structure-of-atoms.html#definition"><i class="fa fa-check"></i><b>18.1</b> Definition</a></li>
<li class="chapter" data-level="18.2" data-path="the-structure-of-atoms.html"><a href="the-structure-of-atoms.html#atom-properties"><i class="fa fa-check"></i><b>18.2</b> Atom Properties</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="the-structure-of-atoms.html"><a href="the-structure-of-atoms.html#mathematical-basics"><i class="fa fa-check"></i><b>18.2.1</b> Mathematical Basics</a></li>
<li class="chapter" data-level="18.2.2" data-path="the-structure-of-atoms.html"><a href="the-structure-of-atoms.html#dimension-sign-and-curvature"><i class="fa fa-check"></i><b>18.2.2</b> Dimension, Sign, and Curvature</a></li>
<li class="chapter" data-level="18.2.3" data-path="the-structure-of-atoms.html"><a href="the-structure-of-atoms.html#additional-characteristics"><i class="fa fa-check"></i><b>18.2.3</b> Additional Characteristics</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="the-structure-of-atoms.html"><a href="the-structure-of-atoms.html#canonicalization"><i class="fa fa-check"></i><b>18.3</b> Canonicalization</a></li>
<li class="chapter" data-level="18.4" data-path="the-structure-of-atoms.html"><a href="the-structure-of-atoms.html#putting-it-all-together"><i class="fa fa-check"></i><b>18.4</b> Putting It All Together</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="future-enhancements.html"><a href="future-enhancements.html"><i class="fa fa-check"></i><b>19</b> Future Enhancements</a>
<ul>
<li class="chapter" data-level="19.1" data-path="future-enhancements.html"><a href="future-enhancements.html#version-1.0"><i class="fa fa-check"></i><b>19.1</b> Version 1.0</a></li>
<li class="chapter" data-level="19.2" data-path="future-enhancements.html"><a href="future-enhancements.html#internal-changes"><i class="fa fa-check"></i><b>19.2</b> Internal Changes</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="references-8.html"><a href="references-8.html"><i class="fa fa-check"></i><b>20</b> References</a></li>
<li class="chapter" data-level="" data-path="references-9.html"><a href="references-9.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Disciplined Convex Optimization in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lasso-and-elastic-net" class="section level1" number="10">
<h1><span class="header-section-number">Chapter 10</span> Lasso and Elastic Net</h1>
<div id="goals-3" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> Goals</h2>
<ul>
<li>Formulate lasso and elastic net regression models</li>
<li>Compare with results from <code>glmnet</code> package</li>
<li>Use loss functions besides squared loss with elastic net penalty</li>
</ul>
</div>
<div id="regularized-regression" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> Regularized Regression</h2>
<p>Often in applications, we encounter problems that require
regularization to prevent overfitting, introduce sparsity, facilitate
variable selection, or impose prior distributions on parameters. Two
of the most common regularization functions are the <span class="math inline">\(l_1\)</span>-norm and
squared <span class="math inline">\(l_2\)</span>-norm, combined in the elastic net regression model
(<span class="citation"><a href="#ref-elasticnet" role="doc-biblioref">H. Zou</a> (<a href="#ref-elasticnet" role="doc-biblioref">2005</a>)</span> and <span class="citation"><a href="#ref-glmnet" role="doc-biblioref">Friedman, Hastie, and Tibshirani</a> (<a href="#ref-glmnet" role="doc-biblioref">2010</a>)</span>).</p>
<p><span class="math display">\[
\begin{array}{ll} 
\underset{\beta}{\mbox{minimize}} &amp; \frac{1}{2m}\|y - X\beta\|_2^2 +
\lambda(\frac{1-\alpha}{2}\|\beta\|_2^2 + \alpha\|\beta\|_1). 
\end{array}
\]</span></p>
<p>Here <span class="math inline">\(\lambda \geq 0\)</span> is the overall regularization weight and
<span class="math inline">\(\alpha \in [0,1]\)</span> controls the relative <span class="math inline">\(l_1\)</span> versus squared <span class="math inline">\(l_2\)</span>
penalty. Thus, this model encompasses both ridge (<span class="math inline">\(\alpha = 0\)</span>) and
lasso (<span class="math inline">\(\alpha = 1\)</span>) regression.</p>
<p>It is convenient to define a function that calculates just the
regularization term given the variable and penalty parameters. This
modular approach will allow us to easily incorporate elastic net
regularization into other regression models as we will see below.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="lasso-and-elastic-net.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Define the elastic penalty</span></span>
<span id="cb48-2"><a href="lasso-and-elastic-net.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param beta the arg min variable</span></span>
<span id="cb48-3"><a href="lasso-and-elastic-net.html#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param lambda the penalization parameter</span></span>
<span id="cb48-4"><a href="lasso-and-elastic-net.html#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param alpha the elastic net parameter, 0 = ridge, 1 = lasso</span></span>
<span id="cb48-5"><a href="lasso-and-elastic-net.html#cb48-5" aria-hidden="true" tabindex="-1"></a>elastic_penalty <span class="ot">&lt;-</span> <span class="cf">function</span>(beta, <span class="at">lambda =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">0</span>) {</span>
<span id="cb48-6"><a href="lasso-and-elastic-net.html#cb48-6" aria-hidden="true" tabindex="-1"></a>    ridge <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">/</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum_squares</span>(beta)</span>
<span id="cb48-7"><a href="lasso-and-elastic-net.html#cb48-7" aria-hidden="true" tabindex="-1"></a>    lasso <span class="ot">&lt;-</span> alpha <span class="sc">*</span> <span class="fu">cvxr_norm</span>(beta, <span class="dv">1</span>)</span>
<span id="cb48-8"><a href="lasso-and-elastic-net.html#cb48-8" aria-hidden="true" tabindex="-1"></a>    lambda <span class="sc">*</span> (lasso <span class="sc">+</span> ridge)</span>
<span id="cb48-9"><a href="lasso-and-elastic-net.html#cb48-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We generate some synthetic sparse data for this example.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="lasso-and-elastic-net.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Problem data</span></span>
<span id="cb49-2"><a href="lasso-and-elastic-net.html#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4321</span>)</span>
<span id="cb49-3"><a href="lasso-and-elastic-net.html#cb49-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb49-4"><a href="lasso-and-elastic-net.html#cb49-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb49-5"><a href="lasso-and-elastic-net.html#cb49-5" aria-hidden="true" tabindex="-1"></a>DENSITY <span class="ot">&lt;-</span> <span class="fl">0.25</span>    <span class="co"># Fraction of non-zero beta</span></span>
<span id="cb49-6"><a href="lasso-and-elastic-net.html#cb49-6" aria-hidden="true" tabindex="-1"></a>beta_true <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(p), <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb49-7"><a href="lasso-and-elastic-net.html#cb49-7" aria-hidden="true" tabindex="-1"></a>idxs <span class="ot">&lt;-</span> <span class="fu">sample.int</span>(p, <span class="at">size =</span> <span class="fu">floor</span>((<span class="dv">1</span> <span class="sc">-</span> DENSITY) <span class="sc">*</span> p), <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb49-8"><a href="lasso-and-elastic-net.html#cb49-8" aria-hidden="true" tabindex="-1"></a>beta_true[idxs] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb49-9"><a href="lasso-and-elastic-net.html#cb49-9" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">45</span></span>
<span id="cb49-10"><a href="lasso-and-elastic-net.html#cb49-10" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> p, <span class="at">sd =</span> <span class="dv">5</span>), <span class="at">nrow =</span> n, <span class="at">ncol =</span> p)</span>
<span id="cb49-11"><a href="lasso-and-elastic-net.html#cb49-11" aria-hidden="true" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n, <span class="at">sd =</span> sigma), <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb49-12"><a href="lasso-and-elastic-net.html#cb49-12" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> X <span class="sc">%*%</span> beta_true <span class="sc">+</span> eps</span></code></pre></div>
<p>We fit the elastic net model for several values of <span class="math inline">\(\lambda\)</span>.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="lasso-and-elastic-net.html#cb50-1" aria-hidden="true" tabindex="-1"></a>TRIALS <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb50-2"><a href="lasso-and-elastic-net.html#cb50-2" aria-hidden="true" tabindex="-1"></a>beta_vals <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> p, <span class="at">ncol =</span> TRIALS)</span>
<span id="cb50-3"><a href="lasso-and-elastic-net.html#cb50-3" aria-hidden="true" tabindex="-1"></a>lambda_vals <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="fu">log10</span>(<span class="dv">50</span>), <span class="at">length.out =</span> TRIALS)</span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="lasso-and-elastic-net.html#cb51-1" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">Variable</span>(p)  </span>
<span id="cb51-2"><a href="lasso-and-elastic-net.html#cb51-2" aria-hidden="true" tabindex="-1"></a>loss <span class="ot">&lt;-</span> <span class="fu">sum_squares</span>(Y <span class="sc">-</span> X <span class="sc">%*%</span> beta) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> n)</span>
<span id="cb51-3"><a href="lasso-and-elastic-net.html#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Elastic-net regression LASSO</span></span>
<span id="cb51-4"><a href="lasso-and-elastic-net.html#cb51-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb51-5"><a href="lasso-and-elastic-net.html#cb51-5" aria-hidden="true" tabindex="-1"></a>beta_vals <span class="ot">&lt;-</span> <span class="fu">sapply</span>(lambda_vals,</span>
<span id="cb51-6"><a href="lasso-and-elastic-net.html#cb51-6" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">function</span> (lambda) {</span>
<span id="cb51-7"><a href="lasso-and-elastic-net.html#cb51-7" aria-hidden="true" tabindex="-1"></a>                        obj <span class="ot">&lt;-</span> loss <span class="sc">+</span> <span class="fu">elastic_penalty</span>(beta, lambda, alpha)</span>
<span id="cb51-8"><a href="lasso-and-elastic-net.html#cb51-8" aria-hidden="true" tabindex="-1"></a>                        prob <span class="ot">&lt;-</span> <span class="fu">Problem</span>(<span class="fu">Minimize</span>(obj))</span>
<span id="cb51-9"><a href="lasso-and-elastic-net.html#cb51-9" aria-hidden="true" tabindex="-1"></a>                        result <span class="ot">&lt;-</span> <span class="fu">solve</span>(prob)</span>
<span id="cb51-10"><a href="lasso-and-elastic-net.html#cb51-10" aria-hidden="true" tabindex="-1"></a>                        result<span class="sc">$</span><span class="fu">getValue</span>(beta)</span>
<span id="cb51-11"><a href="lasso-and-elastic-net.html#cb51-11" aria-hidden="true" tabindex="-1"></a>                    })</span></code></pre></div>
<p>We can now get a table of the coefficients.</p>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 0.010\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 0.026\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 0.066\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 0.171\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 0.441\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 1.135\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 2.924\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 7.533\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 19.408\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 50.000\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{1}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
0.891
</td>
<td style="text-align:right;">
0.890
</td>
<td style="text-align:right;">
0.888
</td>
<td style="text-align:right;">
0.883
</td>
<td style="text-align:right;">
0.870
</td>
<td style="text-align:right;">
0.836
</td>
<td style="text-align:right;">
0.747
</td>
<td style="text-align:right;">
0.553
</td>
<td style="text-align:right;">
0.038
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{2}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
0.040
</td>
<td style="text-align:right;">
0.040
</td>
<td style="text-align:right;">
0.039
</td>
<td style="text-align:right;">
0.036
</td>
<td style="text-align:right;">
0.028
</td>
<td style="text-align:right;">
0.009
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{3}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
0.301
</td>
<td style="text-align:right;">
0.300
</td>
<td style="text-align:right;">
0.299
</td>
<td style="text-align:right;">
0.294
</td>
<td style="text-align:right;">
0.283
</td>
<td style="text-align:right;">
0.254
</td>
<td style="text-align:right;">
0.181
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{4}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
-0.579
</td>
<td style="text-align:right;">
-0.578
</td>
<td style="text-align:right;">
-0.576
</td>
<td style="text-align:right;">
-0.572
</td>
<td style="text-align:right;">
-0.561
</td>
<td style="text-align:right;">
-0.533
</td>
<td style="text-align:right;">
-0.458
</td>
<td style="text-align:right;">
-0.265
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{5}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
0.386
</td>
<td style="text-align:right;">
0.385
</td>
<td style="text-align:right;">
0.384
</td>
<td style="text-align:right;">
0.380
</td>
<td style="text-align:right;">
0.371
</td>
<td style="text-align:right;">
0.347
</td>
<td style="text-align:right;">
0.283
</td>
<td style="text-align:right;">
0.114
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{6}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
1.538
</td>
<td style="text-align:right;">
1.538
</td>
<td style="text-align:right;">
1.536
</td>
<td style="text-align:right;">
1.531
</td>
<td style="text-align:right;">
1.519
</td>
<td style="text-align:right;">
1.487
</td>
<td style="text-align:right;">
1.403
</td>
<td style="text-align:right;">
1.186
</td>
<td style="text-align:right;">
0.627
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{7}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
0.181
</td>
<td style="text-align:right;">
0.180
</td>
<td style="text-align:right;">
0.178
</td>
<td style="text-align:right;">
0.174
</td>
<td style="text-align:right;">
0.163
</td>
<td style="text-align:right;">
0.136
</td>
<td style="text-align:right;">
0.065
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{8}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
-0.134
</td>
<td style="text-align:right;">
-0.134
</td>
<td style="text-align:right;">
-0.132
</td>
<td style="text-align:right;">
-0.127
</td>
<td style="text-align:right;">
-0.114
</td>
<td style="text-align:right;">
-0.082
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{9}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
0.939
</td>
<td style="text-align:right;">
0.938
</td>
<td style="text-align:right;">
0.936
</td>
<td style="text-align:right;">
0.931
</td>
<td style="text-align:right;">
0.918
</td>
<td style="text-align:right;">
0.885
</td>
<td style="text-align:right;">
0.794
</td>
<td style="text-align:right;">
0.570
</td>
<td style="text-align:right;">
0.026
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{10}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
-0.329
</td>
<td style="text-align:right;">
-0.328
</td>
<td style="text-align:right;">
-0.327
</td>
<td style="text-align:right;">
-0.322
</td>
<td style="text-align:right;">
-0.312
</td>
<td style="text-align:right;">
-0.284
</td>
<td style="text-align:right;">
-0.215
</td>
<td style="text-align:right;">
-0.030
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p>We plot the coefficients against the regularization.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="lasso-and-elastic-net.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">type =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;CVXR Regularization Path for Lasso Regression&quot;</span>,</span>
<span id="cb52-2"><a href="lasso-and-elastic-net.html#cb52-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Log Lambda&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Coefficients&quot;</span>,</span>
<span id="cb52-3"><a href="lasso-and-elastic-net.html#cb52-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>))</span>
<span id="cb52-4"><a href="lasso-and-elastic-net.html#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">matlines</span>(<span class="fu">log</span>(lambda_vals), <span class="fu">t</span>(beta_vals))</span></code></pre></div>
<p><img src="cvxr_tutorial_files/figure-html/unnamed-chunk-66-1.png" width="672" /></p>
<p>We then compare with the <code>glmnet</code> results.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="lasso-and-elastic-net.html#cb53-1" aria-hidden="true" tabindex="-1"></a>model_net <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(X, Y, <span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="at">alpha =</span> alpha,</span>
<span id="cb53-2"><a href="lasso-and-elastic-net.html#cb53-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lambda =</span> lambda_vals,</span>
<span id="cb53-3"><a href="lasso-and-elastic-net.html#cb53-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">standardize =</span> <span class="cn">FALSE</span>,</span>
<span id="cb53-4"><a href="lasso-and-elastic-net.html#cb53-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">intercept =</span> <span class="cn">FALSE</span>,</span>
<span id="cb53-5"><a href="lasso-and-elastic-net.html#cb53-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">thresh =</span> <span class="fl">1e-8</span>)</span>
<span id="cb53-6"><a href="lasso-and-elastic-net.html#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Reverse order to match beta_vals</span></span>
<span id="cb53-7"><a href="lasso-and-elastic-net.html#cb53-7" aria-hidden="true" tabindex="-1"></a>coef_net <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.matrix</span>(<span class="fu">coef</span>(model_net)[<span class="sc">-</span><span class="dv">1</span>, <span class="fu">seq</span>(TRIALS, <span class="dv">1</span>, <span class="at">by =</span> <span class="sc">-</span><span class="dv">1</span>)]))</span></code></pre></div>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 0.010\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 0.026\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 0.066\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 0.171\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 0.441\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 1.135\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 2.924\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 7.533\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 19.408\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 50.000\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{1}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
0.891
</td>
<td style="text-align:right;">
0.890
</td>
<td style="text-align:right;">
0.888
</td>
<td style="text-align:right;">
0.883
</td>
<td style="text-align:right;">
0.870
</td>
<td style="text-align:right;">
0.836
</td>
<td style="text-align:right;">
0.747
</td>
<td style="text-align:right;">
0.553
</td>
<td style="text-align:right;">
0.038
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{2}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
0.040
</td>
<td style="text-align:right;">
0.040
</td>
<td style="text-align:right;">
0.039
</td>
<td style="text-align:right;">
0.036
</td>
<td style="text-align:right;">
0.028
</td>
<td style="text-align:right;">
0.009
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{3}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
0.301
</td>
<td style="text-align:right;">
0.300
</td>
<td style="text-align:right;">
0.299
</td>
<td style="text-align:right;">
0.294
</td>
<td style="text-align:right;">
0.283
</td>
<td style="text-align:right;">
0.254
</td>
<td style="text-align:right;">
0.181
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{4}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
-0.579
</td>
<td style="text-align:right;">
-0.578
</td>
<td style="text-align:right;">
-0.576
</td>
<td style="text-align:right;">
-0.572
</td>
<td style="text-align:right;">
-0.561
</td>
<td style="text-align:right;">
-0.533
</td>
<td style="text-align:right;">
-0.458
</td>
<td style="text-align:right;">
-0.265
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{5}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
0.386
</td>
<td style="text-align:right;">
0.385
</td>
<td style="text-align:right;">
0.384
</td>
<td style="text-align:right;">
0.380
</td>
<td style="text-align:right;">
0.371
</td>
<td style="text-align:right;">
0.347
</td>
<td style="text-align:right;">
0.283
</td>
<td style="text-align:right;">
0.114
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{6}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
1.538
</td>
<td style="text-align:right;">
1.538
</td>
<td style="text-align:right;">
1.536
</td>
<td style="text-align:right;">
1.531
</td>
<td style="text-align:right;">
1.519
</td>
<td style="text-align:right;">
1.487
</td>
<td style="text-align:right;">
1.403
</td>
<td style="text-align:right;">
1.186
</td>
<td style="text-align:right;">
0.627
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{7}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
0.181
</td>
<td style="text-align:right;">
0.180
</td>
<td style="text-align:right;">
0.178
</td>
<td style="text-align:right;">
0.174
</td>
<td style="text-align:right;">
0.163
</td>
<td style="text-align:right;">
0.136
</td>
<td style="text-align:right;">
0.065
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{8}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
-0.134
</td>
<td style="text-align:right;">
-0.134
</td>
<td style="text-align:right;">
-0.132
</td>
<td style="text-align:right;">
-0.127
</td>
<td style="text-align:right;">
-0.114
</td>
<td style="text-align:right;">
-0.082
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{9}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
0.939
</td>
<td style="text-align:right;">
0.938
</td>
<td style="text-align:right;">
0.936
</td>
<td style="text-align:right;">
0.931
</td>
<td style="text-align:right;">
0.918
</td>
<td style="text-align:right;">
0.885
</td>
<td style="text-align:right;">
0.794
</td>
<td style="text-align:right;">
0.570
</td>
<td style="text-align:right;">
0.026
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{10}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
-0.329
</td>
<td style="text-align:right;">
-0.328
</td>
<td style="text-align:right;">
-0.327
</td>
<td style="text-align:right;">
-0.322
</td>
<td style="text-align:right;">
-0.312
</td>
<td style="text-align:right;">
-0.284
</td>
<td style="text-align:right;">
-0.215
</td>
<td style="text-align:right;">
-0.030
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<div id="exercise-9" class="section level3" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Exercise</h3>
<p><a href="https://stats.stackexchange.com/questions/334007/elastic-net-in-glmnet-vs-cvxr">A Stack Overflow
Question</a>!</p>
<p><em>Im attempting to match some simple results in R using <code>glmnet</code> and
<code>CVXR</code>. I have the following code.</em></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="lasso-and-elastic-net.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb54-2"><a href="lasso-and-elastic-net.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(QuickStartExample)</span>
<span id="cb54-3"><a href="lasso-and-elastic-net.html#cb54-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> QuickStartExample<span class="sc">$</span>x</span>
<span id="cb54-4"><a href="lasso-and-elastic-net.html#cb54-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> QuickStartExample<span class="sc">$</span>y</span>
<span id="cb54-5"><a href="lasso-and-elastic-net.html#cb54-5" aria-hidden="true" tabindex="-1"></a>catn <span class="ot">&lt;-</span> <span class="cf">function</span>(...) <span class="fu">cat</span>(..., <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb54-6"><a href="lasso-and-elastic-net.html#cb54-6" aria-hidden="true" tabindex="-1"></a>objective_value <span class="ot">&lt;-</span> <span class="cf">function</span>(y, x, coefs, lambda, alpha) {</span>
<span id="cb54-7"><a href="lasso-and-elastic-net.html#cb54-7" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb54-8"><a href="lasso-and-elastic-net.html#cb54-8" aria-hidden="true" tabindex="-1"></a>    ridge <span class="ot">&lt;-</span> <span class="fu">sum</span>(coefs<span class="sc">^</span><span class="dv">2</span>) ; l1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">abs</span>(coefs))</span>
<span id="cb54-9"><a href="lasso-and-elastic-net.html#cb54-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>((y <span class="sc">-</span> (x <span class="sc">%*%</span> coefs))<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> n) <span class="sc">+</span> lambda <span class="sc">*</span> ((<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">/</span> <span class="dv">2</span> <span class="sc">*</span> ridge <span class="sc">+</span> alpha <span class="sc">*</span> l1)</span>
<span id="cb54-10"><a href="lasso-and-elastic-net.html#cb54-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-11"><a href="lasso-and-elastic-net.html#cb54-11" aria-hidden="true" tabindex="-1"></a>alpha  <span class="ot">&lt;-</span> <span class="dv">0</span>; lambda  <span class="ot">&lt;-</span> <span class="dv">1</span>;</span>
<span id="cb54-12"><a href="lasso-and-elastic-net.html#cb54-12" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x, y, <span class="at">intercept=</span>F, <span class="at">standardize=</span>F, <span class="at">lambda=</span><span class="dv">1</span>, <span class="at">alpha=</span><span class="dv">0</span>)</span></code></pre></div>
<p><em>which gives me one set of coefficients and the objective function
value <code>2.559086</code> via</em></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="lasso-and-elastic-net.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">objective_value</span>(y, x, <span class="fu">coef</span>(fit)[<span class="sc">-</span><span class="dv">1</span>, ], lambda, alpha)</span></code></pre></div>
<pre><code>## [1] 2.573793</code></pre>
<p><em>but this <code>CVXR</code> code </em></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="lasso-and-elastic-net.html#cb57-1" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">Variable</span>(<span class="dv">20</span>)</span>
<span id="cb57-2"><a href="lasso-and-elastic-net.html#cb57-2" aria-hidden="true" tabindex="-1"></a>elastic_reg <span class="ot">&lt;-</span> <span class="cf">function</span>(beta, <span class="at">lambda =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">0</span>) {</span>
<span id="cb57-3"><a href="lasso-and-elastic-net.html#cb57-3" aria-hidden="true" tabindex="-1"></a>   ridge <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> <span class="fu">sum</span>(beta<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> .<span class="dv">5</span></span>
<span id="cb57-4"><a href="lasso-and-elastic-net.html#cb57-4" aria-hidden="true" tabindex="-1"></a>   lasso <span class="ot">&lt;-</span> alpha <span class="sc">*</span> <span class="fu">p_norm</span>(beta, <span class="dv">1</span>)</span>
<span id="cb57-5"><a href="lasso-and-elastic-net.html#cb57-5" aria-hidden="true" tabindex="-1"></a>   lambda <span class="sc">*</span> (lasso <span class="sc">+</span> ridge)</span>
<span id="cb57-6"><a href="lasso-and-elastic-net.html#cb57-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-7"><a href="lasso-and-elastic-net.html#cb57-7" aria-hidden="true" tabindex="-1"></a>loss <span class="ot">&lt;-</span> <span class="fu">sum</span>((y <span class="sc">-</span> x <span class="sc">%*%</span> beta)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">length</span>(y))</span>
<span id="cb57-8"><a href="lasso-and-elastic-net.html#cb57-8" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> loss <span class="sc">+</span> <span class="fu">elastic_reg</span>(beta, <span class="at">lambda =</span> <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb57-9"><a href="lasso-and-elastic-net.html#cb57-9" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">Problem</span>(<span class="fu">Minimize</span>(obj))</span>
<span id="cb57-10"><a href="lasso-and-elastic-net.html#cb57-10" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve</span>(prob)</span>
<span id="cb57-11"><a href="lasso-and-elastic-net.html#cb57-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result<span class="sc">$</span>value)</span></code></pre></div>
<pre><code>## [1] 2.172438</code></pre>
<p><em>gives a different objective value <code>2.859259</code> and a somewhat different set of
coefficients. Can you help?</em></p>
<div id="solution-9" class="section level4" number="10.2.1.1">
<h4><span class="header-section-number">10.2.1.1</span> Solution</h4>
<p>To compare glmnet results to <code>CVXR</code> for the Gaussian case, it is
advisable to standardize the response per the <code>glmnet</code> documentation.
Note also that <code>glmnet</code> uses <span class="math inline">\(n\)</span> rather than <span class="math inline">\(n-1\)</span> in the denominator
for <span class="math inline">\(y\)</span>. This will ensure that the <span class="math inline">\(\lambda\)</span> is on the same scale as
shown below.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="lasso-and-elastic-net.html#cb59-1" aria-hidden="true" tabindex="-1"></a>catn <span class="ot">&lt;-</span> <span class="cf">function</span>(...) <span class="fu">cat</span>(..., <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb59-2"><a href="lasso-and-elastic-net.html#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Standardize the y</span></span>
<span id="cb59-3"><a href="lasso-and-elastic-net.html#cb59-3" aria-hidden="true" tabindex="-1"></a>y_s <span class="ot">&lt;-</span> <span class="fu">local</span>({</span>
<span id="cb59-4"><a href="lasso-and-elastic-net.html#cb59-4" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb59-5"><a href="lasso-and-elastic-net.html#cb59-5" aria-hidden="true" tabindex="-1"></a>    m <span class="ot">&lt;-</span> <span class="fu">mean</span>(y); s <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">sqrt</span>(<span class="fu">var</span>(y) <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n));</span>
<span id="cb59-6"><a href="lasso-and-elastic-net.html#cb59-6" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> (y <span class="sc">-</span> m) <span class="sc">/</span> s <span class="do">## scale using 1/n</span></span>
<span id="cb59-7"><a href="lasso-and-elastic-net.html#cb59-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">attr</span>(result, <span class="st">&quot;scaled:center&quot;</span>) <span class="ot">&lt;-</span> m</span>
<span id="cb59-8"><a href="lasso-and-elastic-net.html#cb59-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">attr</span>(result, <span class="st">&quot;scaled:scale&quot;</span>) <span class="ot">&lt;-</span> s</span>
<span id="cb59-9"><a href="lasso-and-elastic-net.html#cb59-9" aria-hidden="true" tabindex="-1"></a>    result</span>
<span id="cb59-10"><a href="lasso-and-elastic-net.html#cb59-10" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>We can do a comparison on the standardized <span class="math inline">\(y\)</span>. First, the <code>glmnet</code> answer:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="lasso-and-elastic-net.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="do">## STANDARDIZED COMPARISON</span></span>
<span id="cb60-2"><a href="lasso-and-elastic-net.html#cb60-2" aria-hidden="true" tabindex="-1"></a>fit_s <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x, y_s, <span class="at">intercept=</span>F, <span class="at">standardize=</span>F, <span class="at">lambda =</span> lambda, <span class="at">alpha=</span>alpha)</span>
<span id="cb60-3"><a href="lasso-and-elastic-net.html#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">catn</span>(<span class="st">&quot;Glmnet objective (scaled y)&quot;</span>,</span>
<span id="cb60-4"><a href="lasso-and-elastic-net.html#cb60-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">objective_value</span>(y_s, x, <span class="fu">coef</span>(fit_s)[<span class="sc">-</span><span class="dv">1</span>], lambda, alpha))</span></code></pre></div>
<pre><code>## Glmnet objective (scaled y) 0.2504412</code></pre>
<p>Next, the <code>CVXR</code> answer:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="lasso-and-elastic-net.html#cb62-1" aria-hidden="true" tabindex="-1"></a>elastic_reg <span class="ot">&lt;-</span> <span class="cf">function</span>(beta, <span class="at">lambda =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">0</span>) {</span>
<span id="cb62-2"><a href="lasso-and-elastic-net.html#cb62-2" aria-hidden="true" tabindex="-1"></a>    ridge <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">/</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum_squares</span>(beta)</span>
<span id="cb62-3"><a href="lasso-and-elastic-net.html#cb62-3" aria-hidden="true" tabindex="-1"></a>    lasso <span class="ot">&lt;-</span> alpha <span class="sc">*</span> <span class="fu">p_norm</span>(beta, <span class="dv">1</span>)</span>
<span id="cb62-4"><a href="lasso-and-elastic-net.html#cb62-4" aria-hidden="true" tabindex="-1"></a>    lambda <span class="sc">*</span> (lasso <span class="sc">+</span> ridge)</span>
<span id="cb62-5"><a href="lasso-and-elastic-net.html#cb62-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-6"><a href="lasso-and-elastic-net.html#cb62-6" aria-hidden="true" tabindex="-1"></a>loss <span class="ot">&lt;-</span> <span class="fu">sum_squares</span>(y_s <span class="sc">-</span> x <span class="sc">%*%</span> beta) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">nrow</span>(x))</span>
<span id="cb62-7"><a href="lasso-and-elastic-net.html#cb62-7" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> loss <span class="sc">+</span> <span class="fu">elastic_reg</span>(beta, <span class="at">lambda =</span> lambda, alpha)</span>
<span id="cb62-8"><a href="lasso-and-elastic-net.html#cb62-8" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">Problem</span>(<span class="fu">Minimize</span>(obj))</span>
<span id="cb62-9"><a href="lasso-and-elastic-net.html#cb62-9" aria-hidden="true" tabindex="-1"></a>beta_est <span class="ot">&lt;-</span> <span class="fu">solve</span>(prob)<span class="sc">$</span><span class="fu">getValue</span>(beta)</span>
<span id="cb62-10"><a href="lasso-and-elastic-net.html#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="fu">catn</span>(<span class="st">&quot;CVXR objective (scaled y):&quot;</span>, <span class="fu">objective_value</span>(y_s, x, beta_est, lambda, alpha))</span></code></pre></div>
<pre><code>## CVXR objective (scaled y): 0.2504412</code></pre>
<p>To work on the non-standardized scale, we need to match the <code>lamba</code>
values as noted by the <code>glmnet</code> authors in Appendix 2 of the package
vignette <span class="citation">(<a href="#ref-glmnet" role="doc-biblioref">Friedman, Hastie, and Tibshirani 2010</a>)</span>.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="lasso-and-elastic-net.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="do">## NONSTANDARDIZED COMPARISON</span></span>
<span id="cb64-2"><a href="lasso-and-elastic-net.html#cb64-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x, y, <span class="at">intercept=</span>F, <span class="at">standardize=</span>F, <span class="at">lambda =</span> lambda, <span class="at">alpha=</span>alpha)</span>
<span id="cb64-3"><a href="lasso-and-elastic-net.html#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">catn</span>(<span class="st">&quot;Glmnet objective (unscaled y)&quot;</span>, <span class="fu">objective_value</span>(y, x, <span class="fu">coef</span>(fit)[<span class="sc">-</span><span class="dv">1</span>], lambda, alpha))</span></code></pre></div>
<pre><code>## Glmnet objective (unscaled y) 2.573793</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="lasso-and-elastic-net.html#cb66-1" aria-hidden="true" tabindex="-1"></a>loss <span class="ot">&lt;-</span> <span class="fu">sum_squares</span>(y <span class="sc">-</span> x <span class="sc">%*%</span> beta) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">nrow</span>(x))</span>
<span id="cb66-2"><a href="lasso-and-elastic-net.html#cb66-2" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> loss <span class="sc">+</span> <span class="fu">elastic_reg</span>(beta, <span class="at">lambda =</span> lambda <span class="sc">/</span> <span class="fu">attr</span>(y_s, <span class="st">&quot;scaled:scale&quot;</span>), alpha)</span>
<span id="cb66-3"><a href="lasso-and-elastic-net.html#cb66-3" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">Problem</span>(<span class="fu">Minimize</span>(obj))</span>
<span id="cb66-4"><a href="lasso-and-elastic-net.html#cb66-4" aria-hidden="true" tabindex="-1"></a>beta_est <span class="ot">&lt;-</span> <span class="fu">solve</span>(prob)<span class="sc">$</span><span class="fu">getValue</span>(beta)</span>
<span id="cb66-5"><a href="lasso-and-elastic-net.html#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">catn</span>(<span class="st">&quot;CVXR objective (unscaled y)&quot;</span>, <span class="fu">objective_value</span>(y, x, beta_est, lambda, alpha))</span></code></pre></div>
<pre><code>## CVXR objective (unscaled y) 2.559093</code></pre>
<p>Finally, we can check that the coefficients are close enough.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="lasso-and-elastic-net.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print_matrix</span>(<span class="fu">round</span>(<span class="fu">cbind</span>(beta_est, <span class="fu">coef</span>(fit)[<span class="sc">-</span><span class="dv">1</span>]), <span class="dv">3</span>), </span>
<span id="cb68-2"><a href="lasso-and-elastic-net.html#cb68-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">row_names =</span> <span class="fu">sprintf</span>(<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">beta_{%d}$&quot;</span>, <span class="fu">seq_len</span>(<span class="dv">20</span>)),</span>
<span id="cb68-3"><a href="lasso-and-elastic-net.html#cb68-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">&quot;CVXR&quot;</span>, <span class="st">&quot;GLMNET&quot;</span>)) </span></code></pre></div>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
CVXR
</th>
<th style="text-align:right;">
GLMNET
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{1}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
1.117
</td>
<td style="text-align:right;">
1.123
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{2}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
0.070
</td>
<td style="text-align:right;">
0.069
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{3}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
0.568
</td>
<td style="text-align:right;">
0.571
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{4}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
0.007
</td>
<td style="text-align:right;">
0.008
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{5}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
-0.683
</td>
<td style="text-align:right;">
-0.687
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{6}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
0.537
</td>
<td style="text-align:right;">
0.539
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{7}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
0.121
</td>
<td style="text-align:right;">
0.121
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{8}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
0.302
</td>
<td style="text-align:right;">
0.304
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{9}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
-0.075
</td>
<td style="text-align:right;">
-0.074
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{10}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
0.054
</td>
<td style="text-align:right;">
0.055
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{11}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
0.143
</td>
<td style="text-align:right;">
0.144
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{12}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
-0.073
</td>
<td style="text-align:right;">
-0.073
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{13}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
-0.029
</td>
<td style="text-align:right;">
-0.029
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{14}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
-0.932
</td>
<td style="text-align:right;">
-0.937
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{15}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
-0.077
</td>
<td style="text-align:right;">
-0.078
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{16}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
0.018
</td>
<td style="text-align:right;">
0.018
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{17}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
0.008
</td>
<td style="text-align:right;">
0.007
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{18}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
0.009
</td>
<td style="text-align:right;">
0.010
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{19}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
0.031
</td>
<td style="text-align:right;">
0.031
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{20}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
-0.784
</td>
<td style="text-align:right;">
-0.790
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="exercise-10" class="section level3" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> Exercise</h3>
<p>Using the data (<code>X</code>, <code>Y</code>) above, solve an elastic net problem with
<a href="https://cvxr.rbind.io/cvxr_functions/">Huber loss</a> using the Huber
threshold <span class="math inline">\(M = 0.5\)</span>.</p>
<div id="solution-10" class="section level4" number="10.2.2.1">
<h4><span class="header-section-number">10.2.2.1</span> Solution</h4>
<p>Just set the loss as follows.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="lasso-and-elastic-net.html#cb69-1" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">Variable</span>(p)  </span>
<span id="cb69-2"><a href="lasso-and-elastic-net.html#cb69-2" aria-hidden="true" tabindex="-1"></a>loss  <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">huber</span>(Y <span class="sc">-</span> X <span class="sc">%*%</span> beta, <span class="at">M =</span> <span class="fl">0.5</span>))</span>
<span id="cb69-3"><a href="lasso-and-elastic-net.html#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Elastic-net regression LASSO</span></span>
<span id="cb69-4"><a href="lasso-and-elastic-net.html#cb69-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb69-5"><a href="lasso-and-elastic-net.html#cb69-5" aria-hidden="true" tabindex="-1"></a>beta_vals <span class="ot">&lt;-</span> <span class="fu">sapply</span>(lambda_vals,</span>
<span id="cb69-6"><a href="lasso-and-elastic-net.html#cb69-6" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">function</span> (lambda) {</span>
<span id="cb69-7"><a href="lasso-and-elastic-net.html#cb69-7" aria-hidden="true" tabindex="-1"></a>                        obj <span class="ot">&lt;-</span> loss <span class="sc">+</span> <span class="fu">elastic_penalty</span>(beta, lambda, alpha)</span>
<span id="cb69-8"><a href="lasso-and-elastic-net.html#cb69-8" aria-hidden="true" tabindex="-1"></a>                        prob <span class="ot">&lt;-</span> <span class="fu">Problem</span>(<span class="fu">Minimize</span>(obj))</span>
<span id="cb69-9"><a href="lasso-and-elastic-net.html#cb69-9" aria-hidden="true" tabindex="-1"></a>                        result <span class="ot">&lt;-</span> <span class="fu">solve</span>(prob)</span>
<span id="cb69-10"><a href="lasso-and-elastic-net.html#cb69-10" aria-hidden="true" tabindex="-1"></a>                        result<span class="sc">$</span><span class="fu">getValue</span>(beta)</span>
<span id="cb69-11"><a href="lasso-and-elastic-net.html#cb69-11" aria-hidden="true" tabindex="-1"></a>                    })</span></code></pre></div>
<p>The estimates are below.</p>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 0.010\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 0.026\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 0.066\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 0.171\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 0.441\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 1.135\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 2.924\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 7.533\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 19.408\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(\lambda = 50.000\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{1}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
0.538
</td>
<td style="text-align:right;">
0.538
</td>
<td style="text-align:right;">
0.538
</td>
<td style="text-align:right;">
0.538
</td>
<td style="text-align:right;">
0.536
</td>
<td style="text-align:right;">
0.534
</td>
<td style="text-align:right;">
0.527
</td>
<td style="text-align:right;">
0.497
</td>
<td style="text-align:right;">
0.431
</td>
<td style="text-align:right;">
0.149
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{2}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
-0.371
</td>
<td style="text-align:right;">
-0.371
</td>
<td style="text-align:right;">
-0.371
</td>
<td style="text-align:right;">
-0.371
</td>
<td style="text-align:right;">
-0.370
</td>
<td style="text-align:right;">
-0.370
</td>
<td style="text-align:right;">
-0.369
</td>
<td style="text-align:right;">
-0.352
</td>
<td style="text-align:right;">
-0.351
</td>
<td style="text-align:right;">
-0.147
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{3}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
0.424
</td>
<td style="text-align:right;">
0.424
</td>
<td style="text-align:right;">
0.424
</td>
<td style="text-align:right;">
0.424
</td>
<td style="text-align:right;">
0.423
</td>
<td style="text-align:right;">
0.422
</td>
<td style="text-align:right;">
0.421
</td>
<td style="text-align:right;">
0.433
</td>
<td style="text-align:right;">
0.391
</td>
<td style="text-align:right;">
0.195
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{4}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
-0.874
</td>
<td style="text-align:right;">
-0.874
</td>
<td style="text-align:right;">
-0.874
</td>
<td style="text-align:right;">
-0.874
</td>
<td style="text-align:right;">
-0.873
</td>
<td style="text-align:right;">
-0.873
</td>
<td style="text-align:right;">
-0.871
</td>
<td style="text-align:right;">
-0.871
</td>
<td style="text-align:right;">
-0.798
</td>
<td style="text-align:right;">
-0.638
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{5}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
-0.129
</td>
<td style="text-align:right;">
-0.129
</td>
<td style="text-align:right;">
-0.129
</td>
<td style="text-align:right;">
-0.129
</td>
<td style="text-align:right;">
-0.129
</td>
<td style="text-align:right;">
-0.129
</td>
<td style="text-align:right;">
-0.130
</td>
<td style="text-align:right;">
-0.128
</td>
<td style="text-align:right;">
-0.084
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{6}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
1.233
</td>
<td style="text-align:right;">
1.233
</td>
<td style="text-align:right;">
1.233
</td>
<td style="text-align:right;">
1.233
</td>
<td style="text-align:right;">
1.233
</td>
<td style="text-align:right;">
1.232
</td>
<td style="text-align:right;">
1.230
</td>
<td style="text-align:right;">
1.237
</td>
<td style="text-align:right;">
1.155
</td>
<td style="text-align:right;">
0.828
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{7}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
-0.067
</td>
<td style="text-align:right;">
-0.067
</td>
<td style="text-align:right;">
-0.066
</td>
<td style="text-align:right;">
-0.066
</td>
<td style="text-align:right;">
-0.066
</td>
<td style="text-align:right;">
-0.064
</td>
<td style="text-align:right;">
-0.060
</td>
<td style="text-align:right;">
-0.023
</td>
<td style="text-align:right;">
-0.059
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{8}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
-0.590
</td>
<td style="text-align:right;">
-0.590
</td>
<td style="text-align:right;">
-0.590
</td>
<td style="text-align:right;">
-0.590
</td>
<td style="text-align:right;">
-0.589
</td>
<td style="text-align:right;">
-0.586
</td>
<td style="text-align:right;">
-0.580
</td>
<td style="text-align:right;">
-0.559
</td>
<td style="text-align:right;">
-0.494
</td>
<td style="text-align:right;">
-0.116
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{9}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
1.419
</td>
<td style="text-align:right;">
1.419
</td>
<td style="text-align:right;">
1.419
</td>
<td style="text-align:right;">
1.418
</td>
<td style="text-align:right;">
1.417
</td>
<td style="text-align:right;">
1.414
</td>
<td style="text-align:right;">
1.407
</td>
<td style="text-align:right;">
1.377
</td>
<td style="text-align:right;">
1.310
</td>
<td style="text-align:right;">
0.987
</td>
</tr>
<tr>
<td style="text-align:left;background-color: #ececec !important;">
<span class="math inline">\(\beta_{10}\)</span>
</td>
<td style="text-align:right;background-color: #ececec !important;">
-0.266
</td>
<td style="text-align:right;">
-0.266
</td>
<td style="text-align:right;">
-0.266
</td>
<td style="text-align:right;">
-0.266
</td>
<td style="text-align:right;">
-0.266
</td>
<td style="text-align:right;">
-0.265
</td>
<td style="text-align:right;">
-0.265
</td>
<td style="text-align:right;">
-0.255
</td>
<td style="text-align:right;">
-0.225
</td>
<td style="text-align:right;">
-0.069
</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-glmnet" class="csl-entry">
. 2010. <span>Regularization Paths for Generalized Linear Models via Coordinate Descent.</span> <em>Journal of Statistical Software</em> 33 (1): 122.
</div>
<div id="ref-elasticnet" class="csl-entry">
H. Zou, T. Hastie. 2005. <span>Regularization and Variable Selection via the ElasticNet.</span> <em>Journal of the Royal Statistical Society B (Methodological)</em> 67 (2): 30120.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="isotonic-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="nearly-isotonic-fits.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["cvxr_tutorial.pdf", "cvxr_tutorial.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
